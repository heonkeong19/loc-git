/*
CREATE DATABASE SAP_TEST


--주문테이블에 단가랑 수량 곱해서 주문금액 만들기

CREATE TABLE CUSTOMER(
	CUST_CD	NVARCHAR(10) NOT NULL,
	CUST_NM	NVARCHAR(20)	NOT NULL,
	CUST_AGE	INT,
	CUST_LVL	NVARCHAR(10),
	CUST_JOB	NVARCHAR(20),
	CUST_POINT	INT,
	PRIMARY KEY(CUST_CD),
	CHECK (CUST_AGE <= 60)
);

CREATE TABLE PRODUCTS(
	PROD_CD	NVARCHAR(10) NOT NULL,
	PROD_NM	NVARCHAR(20) NOT NULL,
	PROD_QY	INT,
	PROD_PRI	DECIMAL(18,4),
	PROD_VEND	NVARCHAR(20),
	PRIMARY KEY(PROD_CD),
	CHECK(PROD_QY>=0 AND PROD_QY<=10000)
);
	
CREATE TABLE ORDERS(	
	ORD_CD	NVARCHAR(10) NOT NULL,
	CUST_CD	NVARCHAR(10)	NOT NULL,
	PROD_CD	NVARCHAR(10)	NOT NULL,
	ORDER_QTY	INT,
	ORDER_ADD	NVARCHAR(20),
	ORDER_REGDT	DATETIME	DEFAULT	GETDATE(),
	ORDER_PRI	INT		DEFAULT 0,
	PRIMARY KEY(ORD_CD),
	FOREIGN KEY(CUST_CD) REFERENCES CUSTOMER(CUST_CD),
	FOREIGN KEY(PROD_CD) REFERENCES PRODUCTS(PROD_CD)
);
--오더 테이블의 주문금액은 단가*수량이다. 
SELECT *, ORDER_QTY*PROD_PRI AS 주문금액
FROM ORDERS O, PRODUCTS P

--판매 테이블에는 데이터 추가하지 않기!
CREATE TABLE SALES(
	SAL_CD	NVARCHAR(10)	NOT NULL,
	CUST_CD	NVARCHAR(10)	NOT NULL,
	SAL_ADD	NVARCHAR(20),
	SAL_REDGT	DATETIME DEFAULT GETDATE(),
	SAL_PRI	INT DEFAULT 0,
	PRIMARY KEY(SAL_CD),
	FOREIGN KEY(SAL_CD) REFERENCES ORDERS(ORD_CD)
);

INSERT INTO CUSTOMER
VALUES
('APPLE', '정소화', 20, 'GOLD', '학생', 1000),
('BANANA', '김선우', 25, 'VIP', '간호사', 2500),
('CARROT', '고명석', 28, 'GOLD', '교사', 4500),
('ORANGE', '김용욱', 22, 'SILVER', '학생', 0),
('MELON', '성원용', 35, 'GOLD', '회사원', 5000),
('PEACH', '오형준', NULL, 'SILVER', '의사', 300),
('PEAR', '채광주', 31, 'SILVER', '회사원', 500),
('CHERRY', '김선정', 35, 'GOLD', '회사원', 5000),
('GRAPE', '오하라', 32, 'SILVER', '배우', 4300),
('TOMATO', '주세린', 32, 'SILVER', '디자이너', 4500),
('A', '정수화', 20, 'GOLD', '학생', 1000),
('B', '김성우', 25, 'VIP', '간호사', 2500),
('C', '고우석', 28, 'GOLD', '교사', 4500),
('D', '김창욱', 22, 'SILVER', '학생', 0),
('E', '성용우', 35, 'GOLD', '회사원', 5000),
('F', '오하준', NULL, 'SILVER', '의사', 300),
('G', '채희주', 31, 'SILVER', '회사원', 500),
('H', '성희용', 35, 'GOLD', '회사원', 5000),
('I', '오나라', 32, 'SILVER', '배우', 4300),
('J', '주예린', 32, 'SILVER', '디자이너', 4500),
('K', '정소희', 20, 'GOLD', '학생', 1000),
('L', '김선욱', 25, 'VIP', '간호사', 2500),
('M', '고명학', 28, 'GOLD', '교사', 4500),
('N', '김용희', 22, 'SILVER', '학생', 0),
('O', '성원영', 35, 'GOLD', '회사원', 5000),
('P', '오형석', NULL, 'SILVER', '의사', 300),
('Q', '채광준', 31, 'SILVER', '회사원', 500),
('R', '성하영', 35, 'GOLD', '회사원', 5000),
('S', '오하영', 32, 'SILVER', '배우', 4300),
('T', '주세영', 32, 'SILVER', '디자이너', 4500),
('U', '정화수', 20, 'GOLD', '학생', 1000),
('V', '김우선', 25, 'VIP', '간호사', 2500),
('W', '고석명', 28, 'GOLD', '교사', 4500),
('X', '김우용', 22, 'SILVER', '학생', 0),
('Y', '성용원', 35, 'GOLD', '회사원', 5000),
('Z', '오준형', NULL, 'SILVER', '의사', 300),
('AA', '채주광', 31, 'SILVER', '회사원', 500),
('BB', '이성원', 35, 'GOLD', '회사원', 5000),
('CC', '하주라', 32, 'SILVER', '배우', 4300),
('DD', '인세주', 32, 'SILVER', '디자이너', 4500),
('EE', '김소화', 20, 'GOLD', '학생', 1000),
('FF', '이선우', 25, 'VIP', '간호사', 2500),
('GG', '주명석', 28, 'GOLD', '교사', 4500),
('HH', '박용욱', 22, 'SILVER', '학생', 0),
('II', '선우원용', 35, 'GOLD', '회사원', 5000),
('JJ', '유형준', NULL, 'SILVER', '의사', 300),
('KK', '오광주', 31, 'SILVER', '회사원', 500),
('LL', '박원용', 35, 'GOLD', '회사원', 5000),
('MM', '주하라', 32, 'SILVER', '배우', 4300),
('NN', '이세린', 32, 'SILVER', '디자이너', 4500),
('OO', '김세화', 20, 'GOLD', '학생', 1000),
('PP', '이서우', 25, 'VIP', '간호사', 2500),
('QQ', '우명석', 28, 'GOLD', '교사', 4500),
('RR', '이명욱', 22, 'SILVER', '학생', 0),
('SS', '김의용', 35, 'GOLD', '회사원', 5000),
('TT', '이명준', NULL, 'SILVER', '의사', 300),
('UU', '채명주', 31, 'SILVER', '회사원', 500),
('VV', '박기영', 35, 'GOLD', '회사원', 5000),
('WW', '주세라', 32, 'SILVER', '배우', 4300),
('XX', '이린', 32, 'SILVER', '디자이너', 4500);

INSERT INTO PRODUCTS
VALUES
('P01', '그냥만두', 5000, 4500, '대한식품'),
('P02', '매운쫄면', 2500, 5500, '민국푸드'),
('P03', '쿵떡파이', 3600, 2600, '한빛제과'),
('P04', '맛난초콜릿', 1250, 2500, '한빛제과'),
('P05', '얼큰라면', 2200, 1200, '대한식품'),
('P06', '통통우동', 1000, 1550, '민국푸드'),
('P07', '달콤비스킨', 1650, 1500, '한빛제과'),
('P08', '짬뽕', 7500, 3500, '민국푸드'),
('P09', '짜장', 7000, 3500, '민국푸드'),
('P10', '탕수육', 10000, 5500, '대한식품'),
('P11', '그냥만두', 5000, 3500, '대한식품'),
('P12', '매운쫄면', 2500, 2500, '민국푸드'),
('P13', '쿵떡파이', 3600, 4600, '한빛제과'),
('P14', '맛난초콜릿', 1250, 2600, '한빛제과'),
('P15', '얼큰라면', 2200, 1100, '대한식품'),
('P16', '통통우동', 1000, 1350, '민국푸드'),
('P17', '달콤비스킨', 1650, 1200, '한빛제과'),
('P18', '짬뽕', 7500, 3500, '민국푸드'),
('P19', '짜장', 7000, 3500, '민국푸드'),
('P20', '탕수육', 10000, 5500, '대한식품'),
('P21', '그냥만두', 5000, 4500, '대한식품'),
('P22', '매운쫄면', 2500, 5500, '민국푸드'),
('P23', '쿵떡파이', 3600, 2600, '한빛제과'),
('P24', '맛난초콜릿', 1250, 2500, '한빛제과'),
('P25', '얼큰라면', 2200, 1200, '대한식품'),
('P26', '통통우동', 1000, 1550, '민국푸드'),
('P27', '달콤비스킨', 1650, 1500, '한빛제과'),
('P28', '짬뽕', 7500, 3500, '민국푸드'),
('P29', '짜장', 7000, 3500, '민국푸드'),
('P30', '그냥만두', 5000, 4500, '대한식품'),
('P31', '그냥만두', 5000, 4500, '대한식품'),
('P32', '매운쫄면', 2500, 5500, '민국푸드'),
('P33', '쿵떡파이', 3600, 2600, '한빛제과'),
('P34', '맛난초콜릿', 1250, 2500, '한빛제과'),
('P35', '얼큰라면', 2200, 1200, '대한식품'),
('P36', '통통우동', 1000, 1550, '민국푸드'),
('P37', '달콤비스킨', 1650, 1500, '한빛제과'),
('P38', '짬뽕', 7500, 3500, '민국푸드'),
('P39', '짜장', 7000, 3500, '민국푸드'),
('P40', '탕수육', 10000, 5500, '대한식품'),
('P41', '그냥만두', 5000, 4500, '대한식품'),
('P42', '매운쫄면', 2500, 5500, '민국푸드'),
('P43', '쿵떡파이', 3600, 2600, '한빛제과'),
('P44', '맛난초콜릿', 1250, 2500, '한빛제과'),
('P45', '얼큰라면', 2200, 1200, '대한식품'),
('P46', '통통우동', 1000, 1550, '민국푸드'),
('P47', '달콤비스킨', 1650, 1500, '한빛제과'),
('P48', '짬뽕', 7500, 3500, '민국푸드'),
('P49', '짜장', 7000, 3500, '민국푸드'),
('P50', '탕수육', 10000, 5500, '대한식품');

SELECT * FROM PRODUCTS


SELECT PROD_PRI*ORDER_QTY AS ORDER_REGDT
FROM ORDERS O, PRODUCTS P

INSERT INTO ORDERS
VALUES
('O01', 'APPLE', 'P03', 10, '서울시 마포구', '2019-01-01', 45000),
('O02', 'MELON', 'P01', 5, '인천시 계양구', '2019-01-10', 55000),
('O03', 'BANANA', 'P06', 45, '경기도 부천시', '2019-01-11', 26000),
('O04', 'CARROT', 'P02', 8, '부산시 금정구', '2019-02-01', 25000),
('O05', 'MELON', 'P06', 36, '경기도 용인시', '2019-02-20', 12000),
('O06', 'BANANA', 'P01', 19, '충청북도 보은군', '2019-03-02', 15500),
('O07', 'APPLE', 'P03', 22, '서울시 영등포구', '2019-03-15', 15000),
('O08', 'PEAR', 'P02', 50, '강원도 춘천시', '2019-04-10', 35000),
('O09', 'BANANA', 'P04', 15, '전라남도 목포시', '2019-04-11', 35000),
('O10', 'CARROT', 'P03', 20, '경기도 안양시', '2019-05-22', 55000),
('O11', 'D', 'P23', 10, '대전시 대덕구', '2019-05-22', 55000),
('O12', 'E', 'P33', 30, '대전시 동구', '2019-03-22', 55000),
('O13', 'F', 'P43', 40, '충청도 대천시', '2018-04-12', 55000),
('O14', 'G', 'P23', 50, '강원도 태백시', '2017-02-02', 55000),
('O15', 'H', 'P31', 60, '전라도 전주시', '2016-03-23', 55000),
('O16', 'I', 'P32', 60, '경상도 대구시', '2015-04-21', 55000),
('O17', 'J', 'P33', 22, '전라도 전주시', '2015-01-19', 55000),
('O18', 'K', 'P42', 23, '강원도 태백시', '2014-02-18', 55000),
('O19', 'L', 'P22', 24, '충청도 대천시', '2013-12-21', 55000),
('O20', 'M', 'P13', 25, '전라도 전주시', '2014-02-23', 55000),
('O21', 'N', 'P14', 21, '전라도 전주시', '2015-03-24', 55000),
('O22', 'O', 'P24', 22, '경상도 대구시', '2016-03-18', 55000),
('O23', 'P', 'P50', 23, '경상도 대구시', '2017-01-19', 55000),
('O24', 'Q', 'P23', 24, '전라도 전주시', '2018-02-10', 55000),
('O25', 'R', 'P33', 25, '대전시 서구', '2019-02-22', 55000),
('O26', 'S', 'P13', 21, '충청도 대천시', '2019-05-12', 55000),
('O27', 'T', 'P23', 22, '전라도 전주시', '2018-05-03', 55000),
('O28', 'U', 'P33', 31, '경상도 대구시', '2020-05-12', 55000),
('O29', 'W', 'P44', 12, '전라남도 목포시', '2020-04-08', 35000),
('O30', 'SS', 'P33', 33, '경기도 안양시', '2020-02-22', 55000),
('O31', 'QQ', 'P33', 44, '서울시 마포구', '2020-01-01', 45000),
('O32', 'VV', 'P21', 55, '인천시 계양구', '2021-01-10', 55000),
('O33', 'MM', 'P26', 65, '경기도 부천시', '2020-03-11', 26000),
('O34', 'CC', 'P22', 34, '부산시 금정구', '2021-04-01', 25000),
('O35', 'LL', 'P36', 36, '경기도 용인시', '2020-05-20', 12000),
('O36', 'II', 'P31', 29, '충청북도 보은군', '2021-03-02', 15500),
('O37', 'PP', 'P43', 32, '서울시 영등포구', '2020-03-15', 15000),
('O38', 'RR', 'P22', 40, '강원도 춘천시', '2020-04-10', 35000),
('O39', 'NN', 'P34', 15, '전라남도 목포시', '2020-04-01', 35000),
('O40', 'A', 'P33', 240, '경기도 안양시', '2020-06-22', 55000),
('O41', 'B', 'P23', 230, '경기도 안양시', '2020-06-22', 55000),
('O42', 'C', 'P13', 240, '경기도 안양시', '2020-06-22', 55000),
('O43', 'D', 'P24', 230, '경기도 안양시', '2020-06-22', 55000),
('O44', 'EE', 'P44', 230, '경기도 안양시', '2020-06-22', 55000),
('O45', 'E', 'P26', 46, '경기도 용인시', '2021-02-20', 12000),
('O46', 'L', 'P21', 39, '충청북도 보은군', '2020-03-02', 15500),
('O47', 'X', 'P23', 24, '서울시 영등포구', '2021-03-15', 15000),
('O48', 'I', 'P12', 530, '강원도 춘천시', '2021-04-09', 35000),
('O49', 'O', 'P14', 135, '전라남도 목포시', '2020-04-11', 35000),
('O50', 'A', 'P13', 230, '경기도 안양시', '2020-05-22', 55000);


/*
이력
- 주문테이블 
- 지금까지 얼마나 일을 했는가
- 우리가 지금 사용하는 테이블들

조회
- 완료 처리가 되는 순간 사라짐
- 앞으로 일할 거

현황
- 집계함수 사용
- 정리할 때 사용
*/

/*어떤 테이블에 어떤 컬럼이 어떤 속성이 생성이 되었다. NOT NULL이면 NULL값이 들어갈 수 없다.
디폴트 값 있으면 기본적으로 0이 들어간다.

SELECT 하단에 뷰 -> 그거 그대로 적기
출력 결과 적기
밑에다 컬럼이름 3개~4개
데이터 나오는 값들 칸 맞춰서 적어주기
*/

SELECT * FROM CUSTOMER
SELECT * FROM PRODUCTS
SELECT * FROM ORDERS
--드래그해서 엑셀에 붙여넣기 하면 붙여넣어짐!!!

UPDATE ORDERS
SET ORDER_PRI = ORDER_QTY * PROD_PRI
FROM ORDERS LEFT OUTER JOIN PRODUCTS
ON ORDERS.PROD_CD = PRODUCTS.PROD_CD

SELECT * FROM SALES
SELECT * FROM ORDERS

--주문테이블 제일 위에 있는 3개 01, 02, 03이 판매완료가 되었으니 추가해줘라.
INSERT INTO SALES
VALUES
('O02', 'MELON', '', '2021-04-09', NULL),
('O03', 'BANANA', '서울시 마포구', '2021-04-09', NULL),
('O05', 'MELON', '서울시 마포구', '2021-04-09', NULL);

WHERE ORD_CD = SAL_CD
UPDATE SALES
SET SAL_PRI = ORDER_PRI
FROM ORDERS
WHERE SAL_CD = ORD_CD


UPDATE SALES
SET SAL_PRI = ORDER_PRI
FROM ORDERS
WHERE SAL_CD = ORD_CD

--애플이 회원탈퇴
--DELETE FROM CUSTOMER
--WHERE CUST_CD = 'APPLE'

--제품 테이블에 새로운 제품 2개 추가
SELECT * FROM PRODUCTS

INSERT INTO PRODUCTS
VALUES
('P51', '깐풍기', 4400, 5000, '민국푸드'),
('P52', '마라탕', 5500, 10000, '민국푸드'),
('P53', '돼지국밥', 6600, 9000, '민국푸드');

--고객명 바나나가 P04를 20
SELECT * FROM ORDERS

INSERT INTO ORDERS
VALUES
('O51', 'BANANA', 'P04', 20, '경기도 부천시', DEFAULT, '')

--주문 O04 판매완료
SELECT * FROM SALES
SELECT * FROM ORDERS
WHERE ORD_CD = 'O04'

INSERT INTO SALES 
VALUES
('O04', 'CARROT', '부산시 금정구', DEFAULT, DEFAULT)

UPDATE SALES 
SET SAL_PRI = 44000
WHERE SAL_PRI = 'O04'

SELECT * FROM SALES

--오렌지 고객이 회원탈퇴
--DELETE FROM ORDERS
--WHERE CUST_CD = 'ORANGE'

--적립금 2000원 기본

--현재 고객들의 적립금을 50% 올려줙라
UPDATE CUSTOMER
SET CUST_POINT = CUST_POINT*1.5

--고객 3명 신규가입, 적립금 기본 2000원
SELECT * FROM CUSTOMER 

INSERT INTO CUSTOMER
VALUES
('AAA', '김무명', 22, 'SILVER', '학생', 2000),
('BBB', '김유명', 23, 'SILVER', '학생', 2000),
('CCC', '김이명', 24, 'SILVER', '학생', 2000);

--바나나 고객의 적립금을 2500원 올려줌.
UPDATE CUSTOMER
SET CUST_POINT = CUST_POINT + 2500
WHERE CUST_CD = 'BANANA'


SELECT * FROM ORDERS
SELECT * FROM SALES

--주문 정보에 있는 4건의 데이터가 판매완료됨.
INSERT INTO SALES
VALUES
('O06', 'BANANA', '','',''), 
('O08', 'PEAR','','','')

SELECT * FROM SALES

UPDATE SALES
SET SAL_REGDT = DEFAULT
FROM ORDERS
WHERE SAL_CD = ORD_CD



--더블클릭 하면 잡아줌
--바인딩 에러 = 이름을 제대로 지정해주지 않았을 때

SELECT * FROM SALES
SELECT * FROM ORDERS

--멜론이 P05를 30개 구매함
INSERT INTO ORDERS
VALUES('O52', 'MELON', 'P05', 30, '', DEFAULT, DEFAULT)
*/

 SELECT * FROM ORDERS
 SELECT * FROM SALES

--주문 2개가 판매완료됨. 가장 최근 주문
 INSERT INTO SALES
 VALUES
 ('O 